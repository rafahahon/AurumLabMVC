@model AurumLab.Models.DispositivosViewModel
@{
    Layout = null;
}

<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Aurum Lab - Dispositivos</title>

  <link rel="stylesheet" href="~/styles/global.css">
  <link rel="stylesheet" href="~/styles/dispositivos.css">
</head>
<body>
  <div class="layout">
    <!-- Barra lateral -->
    <aside class="barra-lateral">
      <a class="marca" href="~/Dashboard/Dashboard">
        <img class="logo" src="~/assets/img/icone-logo.svg" alt="">
      </a>

      <nav class="menu-lateral">
        <ul class="lista-atalhos">
          <div class="atalhos-topo">
            <li>
              <a class="atalho" href="~/Dashboard/Dashboard" title="Dashboard">
                <img class="icone-aside" src="~/assets/icon/chart-simple-white.svg" alt="">
              </a>
            </li>
            <li>
              <a class="atalho" href="~/Perfil/Index" title="Perfil">
                <img class="icone-aside" src="~/assets/icon/user-circle.svg" alt="">
              </a>
            </li>
            <li>
              <a class="atalho ativo" href="#" title="Dispositivos">
                <img class="icone-aside" src="~/assets/icon/desktop-black.svg" alt="">
              </a>
            </li>
          </div>

          <li>
            <a class="atalho" href="~/Login/Sair" title="Sair">
              <img class="icone-aside" src="~/assets/icon/arrow-right-from-bracket.svg" alt="">
            </a>
          </li>
        </ul>
      </nav>
    </aside>

    <!-- Conteúdo -->
    <div class="conteudo">
      <header class="topo">
        <div class="titulo-area">
          <h1 class="titulo-pagina">Dispositivos cadastrados</h1>
          <span class="linha-titulo"></span>
        </div>

        <div class="perfil-usuario">
            <span class="saudacao">Olá, @Model.NomeUsuario!</span>
            <img class="avatar" src="@Model.FotoUsuario" alt="Foto do usuário">
        </div>
      </header>

      <!-- Filtros -->
      <form class="filtros" method="get" asp-controller="Dispositivos" asp-action="Index">
        
        <!-- Busca -->
        <div class="campo-busca">
          <img class="icone-busca" src="~/assets/icon/search.svg" alt="">
          <input 
             type="search"
             name="busca"
             placeholder="Buscar dispositivos"
             value="@Model.Busca" />
        </div>

        <!-- Selects -->
        <div class="select-linha">

          <!-- Tipos -->
          <div class="select-wrapper select-filtro">
            <select name="tipoId" onchange="this.form.submit()">
                <option value="">Todos os tipos</option>

                @foreach (var tipo in Model.Tipos)
                {
                    if (tipo.IdTipoDispositivo == Model.TipoIdSelecionado)
                    {
                        <option value="@tipo.IdTipoDispositivo" selected>@tipo.Nome</option>
                    }
                    else
                    {
                        <option value="@tipo.IdTipoDispositivo">@tipo.Nome</option>
                    }
                }
            </select>
          </div>

          <!-- Locais -->
          <div class="select-wrapper select-filtro">
            <select name="localId" onchange="this.form.submit()">
                <option value="">Todas as localidades</option>

                @foreach (var local in Model.Locais)
                {
                    if (local.IdLocal == Model.LocalIdSelecionado)
                    {
                        <option value="@local.IdLocal" selected>@local.Nome</option>
                    }
                    else
                    {
                        <option value="@local.IdLocal">@local.Nome</option>
                    }
                }
            </select>
          </div>

        </div>
      </form>

      <!-- Tabela -->
      <section class="secao-tabela">
        <div class="tabela-responsiva">
          <table class="tabela">
            <thead>
              <tr>
                <th>Nome</th>
                <th>Tipo</th>
                <th>Local</th>
                <th>Número</th>
                <th>Última Manutenção</th>
                <th class="col-acoes">Ações</th>
              </tr>
            </thead>

            <tbody>
              @if (Model.Dispositivos.Any())
              {
                  @foreach (var dispositivo in Model.Dispositivos)
                  {
                      <tr>
                          <td>@dispositivo.Nome</td>
                          <td>@dispositivo.IdTipoDispositivoNavigation.Nome</td>
                          <td>@dispositivo.IdLocalNavigation.Nome</td>
                          <td>@dispositivo.NumeroDispositivo</td>
                          <td>
                              @(dispositivo.DataUltimaManutencao.HasValue
                                  ? dispositivo.DataUltimaManutencao.Value.ToString("dd/MM/yyyy")
                                  : "-")
                          </td>

                          <td class="acoes">
                            <form asp-controller="Dispositivos" asp-action="Excluir" method="post" style="display:inline;">
                                <input type="hidden" name="id" value="@dispositivo.IdDispositivo" />
                                <button type="submit" class="acao icone-btn" title="Excluir"
                                        onclick="return confirm('Tem certeza que deseja excluir este dispositivo?')">
                                    <img src="~/assets/icon/trash.svg" alt="">
                                </button>
                            </form>
                                                                                                
                              <a class="acao icone-btn"
                                href="~/Dispositivos/Editar/@dispositivo.IdDispositivo"
                                title="Editar">
                                  <img src="~/assets/icon/pen.svg" alt="">
                              </a>

                          </td>
                      </tr>
                  }
              }
              else
              {
                  <tr>
                      <td colspan="6">Nenhum dispositivo encontrado com os filtros informados.</td>
                  </tr>
              }
            </tbody>

          </table>
        </div>

        <!-- Paginação -->
        <div class="paginacao">
          <span>Página <span>1</span> de <span>1</span></span>
          <button class="proxima" title="Próxima página" type="button">
            <img src="~/assets/icon/angle-right.svg" alt="">
          </button>
        </div>

      </section>
    </div>
  </div>
</body>
</html>
